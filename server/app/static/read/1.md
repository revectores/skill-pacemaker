# 变量

### 0. Motivation

我们已经知道如何在交互式利用Python实现一些基础的计算功能，例如基本的四则运算

```python
>>> 12 + 21
33
>>> 17 / 3
5.666666666666667
>>> 17 // 3
5
```

考虑这样一个问题，现在你是一位pizza销售员工，你的任务之一是计算送到你面前的每一份pizza的价格，而pizza的价格和pizza的面积成正比，假如这个比例系数是5.2, 那么你可能需要不断重复这样的计算过程：

```python
>>> 12*12 * 3.1415926 * 5.2
2352.42453888
>>> 6*6 * 3.1415926 * 5.2
588.10613472
```

逐渐地你会对反复输入`3.1415926 * 5.2`这么一长串的计算式感到厌烦，希望能将这个在每一次计算中都一样的数字保存下来，而不是每一次都重新输入重新计算，这时候我们就需要使用**变量(variable)**.







### 1. 变量赋值

##### # 基础赋值操作

变量是数据存储的场所，直观地看，是我们为数据赋予的一个名字，我们使用一个等号`=`将变量的名字和我们希望赋予它的数值联系起来：

```python
>>> price_coef = 3.1415926 * 5.2
```

这样, `price_coef`就存储了`3.1415926 * 5.2` 的计算结果，在运算过程中变量和它所存储的实际数值的效果是完全一样的，因此之后计算时只需要用`price_coef`这个名字来代替`3.1415926 * 5.2`:

```python
>>> 3 * 3 * price_coef
147.02653368
```

同样可以使用输出语句`print()`来输出变量中存储的数值：

```python
>>> print(price_coef)
16.33628152
```



##### # 动态类型语言

变量中存储的值可以发生变化，例如pizza某一天涨价到了单位面积5.5元：

 ```python
>>> price_coef = 3.1415926 * 5.5
 ```

你仍然可以用和之前相同的语句来计算价格，但变量中存储的值已经发生了变化. 值得注意的是，变量的值甚至可以从一种**数据类型(data type)**变成另一种数据类型，例如我们可以将`price_coef`设置为一个字符串：

```python
>>> price_coef = "price"
```

请注意这并不是一个平凡的操作，一旦我们将变量`price_coef`从原先的数字类型变成字符串类型，原先的我们打算进行的`r * r * price_coef`形式的乘法操作将失去意义，不再具备计算pizza总价格的功能. 类似的情况如果出现在复杂程序中就极有可能造成难以检测的Bug.

变量的数据类型可以在运行过程中发生变化，这是Python作为**动态类型语言(dynamic type language)**的特性. C等**静态类型语言(static type language)**不允许将原本存储数字的变量转为存储字符串. Python通过动态的特性使得对变量的操作更为自由，但同时也引入了潜在的错误风险.







### 2. 变量命名

就形式上而言，变量的名字只要符合语法即可，究竟叫做什么并不影响程序的运行，但正如Guido van Rossum所说

> "Code is read much more often than it is written."

我们的代码不仅仅是给计算机执行，同时通常也要给包括未来的自己在内的其他人阅读与修改. 代码的可读性直接影响自己和他人的代码理解与开发效率，而一个有意义的变量名则对代码可读性有重要影响，正因如此，变量命名是程序设计（以至软件工程）中极端重要的一部分.



##### # 语法规则

**变量命名(variable naming)**服从两条底线语法规则：

- 变量名可以包含任何大小写字母、数字及下划线.
- 变量名必须以字母或下划线开头，不能以数字开头.

变量名区分大小写，也就是说`person`和`Person`是两个不同的变量. 另外，变量命名不能和Python的语法关键词重复，例如`if`, `for`等等.



##### # camelCase vs underscore_case

为了给变量起一个有意义的名字，我们通常需要使用多个单词，例如一个人的年龄`personage`, 这种直接将单词连在一起的写法十分令人迷惑，很容易识别成是同一个单词，可读性很差，通常我们有两种不同的风格解决这个问题：

- 下划线命名法. 单词字母全部小写，将不同的单词用下划线分隔开，即`person_age`.
- 驼峰命名法. 除了第一个单词，将在变量名中间的单词首字母大写，即`personAge`.

Python的语法风格指南(PEP 8)推荐对变量使用下划线命名法.



##### # 名副其实

变量命名的一个最基本的原则就是，变量名称应当恰到好处地表达其所代表的意义，而不应该随意起一个令人迷惑的名字然后靠额外的注释去补充，好的代码应当是**自解释的(self-explained)**, 代码本身就应当解释了自己的意义. 如果你在写一个路径规划程序，应当使用`source`, `destination`来表达起点和终点，而不是`i`, `j`. 如果你在写一个五子棋游戏，应当用`game_board`来表示你的棋盘对象，而不是`qp`. 如果你在写一个计时程序，应当使用`seconds_after_last_click`来表达自上一次点击过后经过的总秒数，而不是`sec`.



##### # CONSTANT

某些情况下我们十分确定我们在未来不会改变某些变量的值，例如`pi = 3.1415926`, 这时候我们可以将其视为是一个**常量(Constant)**. 之所以说是“视为”，是因为Python不提供语法手段来将一个量规定为常量，并且禁止修改它的值. 这同样也是Python语法自由的一个表现，毕竟

> "We are all consenting adults here."

因为我们都是负责任并且成熟的大人，所以我相信你不会乱来. 当然，为了提示自己和他人“这是一个常量，所以我不要改变它”，我们通常将常量的名称中的字母全部大写: `PI = 3.1415926`.



##### # 可读性驱动的变量引入

创建一个变量有时候并非是复用的要求，而是为了更好的可读性. 仍然以上面的pizza价格计算的程序为例，如果没有背景知识，不容易看出来以下代码的作用

```python
print(12*12 * 3.1415926 * 5.2)
```

但如果我们对数字都起一个合适的名字再让它们参与运算，效果就会截然不同

```python
PI = 3.1415926
radius = 12
pizza_unit_price = 5.2
pizza_price = (radius * radius * PI) * pizza_unit_price
print(pizza_price)
```

通过为数据进行合适的命名，我们引入了关于这些数据的意义，使得代码的意义更加明确.

除了对数字进行命名之外，我们还可以通过将中间结果拆分出来使得计算的每一步骤都有更加明确的意义，例如在上述代码中，我们还可以将计算pizza面积的部分拆分出来：

```python
PI = 3.14159236
radius = 12
pizza_unit_price = 5.2

pizza_area = radius * radius * PI
pizza_price = pizza_area * pizza_unit_price

print(pizza_price)
```

在这里我们引入了中间变量`pizza_area`, 这个变量的引入使得计算的过程更加清晰. 值得注意的是，在这个例子中我们还使用了另外一个可读性提升技巧：即通过空行将代码进行分组，分组后的三个部分分别行使变量初始化、计算和输出三个职能，每一部分的功能都更加明确.







### 3. 习题

1. 为什么我们要引入变量？

2. 如何创建和修改变量的值？

3. 在"动态类型语言"小节中，我们将`price_coef`修改成了字符串`price`, 此时乘法运算`2*2*price_coef`会得到什么结果？

4. 变量命名的两条语法规则是什么？

5. 变量命名的两种风格是什么？在Python中我们推荐使用哪一种风格？

6. 仿照pizza价格计算程序最终版本的风格，应用规范的变量命名手段，写一段计算罐装可乐价格的程序，假设可乐罐视为圆柱，高为`12.5`, 底面半径为`3.25`，单位体积可乐价格系数为`0.01`.

